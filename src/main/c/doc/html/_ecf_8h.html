<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>SLIM Curve: Ecf.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">SLIM Curve
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">SLIM-curve package for exponential curve fitting of spectral lifetime data.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Ecf.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>SLIM Curve - Exponential Curve Fitting Header.  
<a href="#details">More...</a></p>

<p><a href="_ecf_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a603ad628eaeb162f9f6326cbec927b89"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> { <br/>
&#160;&#160;<b>NOISE_CONST</b>, 
<b>NOISE_GIVEN</b>, 
<b>NOISE_POISSON_DATA</b>, 
<b>NOISE_POISSON_FIT</b>, 
<br/>
&#160;&#160;<b>NOISE_GAUSSIAN_FIT</b>, 
<b>NOISE_MLE</b>
<br/>
 }</td></tr>
<tr class="memdesc:a603ad628eaeb162f9f6326cbec927b89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Noise Type.  <a href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">More...</a><br/></td></tr>
<tr class="separator:a603ad628eaeb162f9f6326cbec927b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02b14794ec966816ffe397474b985361"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#a02b14794ec966816ffe397474b985361">fit_type</a> { <b>FIT_GLOBAL_MULTIEXP</b>, 
<b>FIT_GLOBAL_STRETCHEDEXP</b>
 }</td></tr>
<tr class="memdesc:a02b14794ec966816ffe397474b985361"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fit Type.  <a href="_ecf_8h.html#a02b14794ec966816ffe397474b985361">More...</a><br/></td></tr>
<tr class="separator:a02b14794ec966816ffe397474b985361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab577c048e57126ea37f6656e97e547e7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> { <b>ECF_RESTRAIN_DEFAULT</b>, 
<b>ECF_RESTRAIN_USER</b>
 }</td></tr>
<tr class="memdesc:ab577c048e57126ea37f6656e97e547e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restrain Type.  <a href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">More...</a><br/></td></tr>
<tr class="separator:ab577c048e57126ea37f6656e97e547e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7790a7e8ebdca31efd349e44add17cd9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#a7790a7e8ebdca31efd349e44add17cd9">GCI_triple_integral_fitting_engine</a> (float xincr, float y[], int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float *Z, float *A, float *tau, float *fitted, float *residuals, float *chisq, float chisq_target)</td></tr>
<tr class="memdesc:a7790a7e8ebdca31efd349e44add17cd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main entry point for Triple Integral or Rapid Lifetime Determination (RLD).  <a href="#a7790a7e8ebdca31efd349e44add17cd9">More...</a><br/></td></tr>
<tr class="separator:a7790a7e8ebdca31efd349e44add17cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94bbfd4c5b3d3a79fd840731954f3976"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#a94bbfd4c5b3d3a79fd840731954f3976">GCI_marquardt_fitting_engine</a> (float xincr, float *trans, int ndata, int fit_start, int fit_end, float prompt[], int nprompt, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float param[], int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, void(*fitfunc)(float, float[], float *, float[], int), float *fitted, float *residuals, float *chisq, float **covar, float **alpha, float **erraxes, float chisq_target, float chisq_delta, int chisq_percent)</td></tr>
<tr class="memdesc:a94bbfd4c5b3d3a79fd840731954f3976"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main entry point for LM and MLE fitting.  <a href="#a94bbfd4c5b3d3a79fd840731954f3976">More...</a><br/></td></tr>
<tr class="separator:a94bbfd4c5b3d3a79fd840731954f3976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad62c421e86238246287fc9cadf4bf171"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#ad62c421e86238246287fc9cadf4bf171">GCI_triple_integral</a> (float xincr, float y[], int fit_start, int fit_end, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float *Z, float *A, float *tau, float *fitted, float *residuals, float *chisq, int division)</td></tr>
<tr class="memdesc:ad62c421e86238246287fc9cadf4bf171"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start with an easy one: the three integral method.  <a href="#ad62c421e86238246287fc9cadf4bf171">More...</a><br/></td></tr>
<tr class="separator:ad62c421e86238246287fc9cadf4bf171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c72ce45f467e73bdbfdeecba86a2d3a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c72ce45f467e73bdbfdeecba86a2d3a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_triple_integral_instr</b> (float xincr, float y[], int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float *Z, float *A, float *tau, float *fitted, float *residuals, float *chisq, int division)</td></tr>
<tr class="separator:a3c72ce45f467e73bdbfdeecba86a2d3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbaf55df7653f2f443e38b6f6b1e1a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#a5bbaf55df7653f2f443e38b6f6b1e1a9">GCI_marquardt</a> (float x[], float y[], int ndata, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float param[], int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, void(*fitfunc)(float, float[], float *, float[], int), float *fitted, float *residuals, float **covar, float **alpha, float *chisq, float chisq_delta, float chisq_percent, float **erraxes)</td></tr>
<tr class="memdesc:a5bbaf55df7653f2f443e38b6f6b1e1a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Now for the non-linear least squares fitting algorithms.  <a href="#a5bbaf55df7653f2f443e38b6f6b1e1a9">More...</a><br/></td></tr>
<tr class="separator:a5bbaf55df7653f2f443e38b6f6b1e1a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a527b18f8e48919e46f32af4889662f48"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a527b18f8e48919e46f32af4889662f48"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_marquardt_instr</b> (float xincr, float y[], int ndata, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float param[], int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, void(*fitfunc)(float, float[], float *, float[], int), float *fitted, float *residuals, float **covar, float **alpha, float *chisq, float chisq_delta, float chisq_percent, float **erraxes)</td></tr>
<tr class="separator:a527b18f8e48919e46f32af4889662f48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e45e21bc6592ea929a9b103fe9c4d2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a26e45e21bc6592ea929a9b103fe9c4d2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_marquardt_cleanup</b> (void)</td></tr>
<tr class="separator:a26e45e21bc6592ea929a9b103fe9c4d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaf97138127a9b5b4db9de0c15a95742"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#adaf97138127a9b5b4db9de0c15a95742">GCI_marquardt_global_exps_instr</a> (float xincr, float **trans, int ndata, int ntrans, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], int ftype, float **param, int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, float **fitted, float **residuals, float chisq_trans[], float *chisq_global, int *df, int drop_bad_transients)</td></tr>
<tr class="memdesc:adaf97138127a9b5b4db9de0c15a95742"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global analysis analysis function for exponential functions.  <a href="#adaf97138127a9b5b4db9de0c15a95742">More...</a><br/></td></tr>
<tr class="separator:adaf97138127a9b5b4db9de0c15a95742"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac92d80a24a54ae6853e5c49de4e965ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#ac92d80a24a54ae6853e5c49de4e965ab">GCI_marquardt_global_generic_instr</a> (float xincr, float **trans, int ndata, int ntrans, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float **param, int paramfree[], int nparam, int gparam[], <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, void(*fitfunc)(float, float[], float *, float[], int), float **fitted, float **residuals, float chisq_trans[], float *chisq_global, int *df)</td></tr>
<tr class="memdesc:ac92d80a24a54ae6853e5c49de4e965ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global analysis analysis function for generic functions.  <a href="#ac92d80a24a54ae6853e5c49de4e965ab">More...</a><br/></td></tr>
<tr class="separator:ac92d80a24a54ae6853e5c49de4e965ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1168eba7dd501dd4427c436d6351d1d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#ae1168eba7dd501dd4427c436d6351d1d">GCI_SPA_1D_marquardt</a> (float x[], float y[], int ndata, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float param[], int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, void(*fitfunc)(float, float[], float *, float[], int), int spa_param, int spa_nvalues, float spa_low, float spa_high, float chisq[], void(*progressfunc)(float))</td></tr>
<tr class="memdesc:ae1168eba7dd501dd4427c436d6351d1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">GCI_SPA_1D_* performs a 1-dimensional support plane analysis.  <a href="#ae1168eba7dd501dd4427c436d6351d1d">More...</a><br/></td></tr>
<tr class="separator:ae1168eba7dd501dd4427c436d6351d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b39dab2b8a463ca924475c8633696e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#a1b39dab2b8a463ca924475c8633696e2">GCI_SPA_2D_marquardt</a> (float x[], float y[], int ndata, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float param[], int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, void(*fitfunc)(float, float[], float *, float[], int), int spa_param1, int spa_nvalues1, float spa_low1, float spa_high1, int spa_param2, int spa_nvalues2, float spa_low2, float spa_high2, float **chisq, void(*progressfunc)(float))</td></tr>
<tr class="memdesc:a1b39dab2b8a463ca924475c8633696e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">GCI_SPA_2D_* performs a 2-dimensional support plane analysis.  <a href="#a1b39dab2b8a463ca924475c8633696e2">More...</a><br/></td></tr>
<tr class="separator:a1b39dab2b8a463ca924475c8633696e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3f8e4749667b5b5f1720d73ce50763"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e3f8e4749667b5b5f1720d73ce50763"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_SPA_1D_marquardt_instr</b> (float xincr, float y[], int ndata, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float param[], int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, void(*fitfunc)(float, float[], float *, float[], int), int spa_param, int spa_nvalues, float spa_low, float spa_high, float chisq[], float chisq_target, void(*progressfunc)(float))</td></tr>
<tr class="separator:a9e3f8e4749667b5b5f1720d73ce50763"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaff4047b469c3733f1a96002c5245b24"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaff4047b469c3733f1a96002c5245b24"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_SPA_2D_marquardt_instr</b> (float xincr, float y[], int ndata, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float param[], int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, void(*fitfunc)(float, float[], float *, float[], int), int spa_param1, int spa_nvalues1, float spa_low1, float spa_high1, int spa_param2, int spa_nvalues2, float spa_low2, float spa_high2, float **chisq, float chisq_target, void(*progressfunc)(float))</td></tr>
<tr class="separator:aaff4047b469c3733f1a96002c5245b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a453a6f925407eca916460aceb57c77cb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a453a6f925407eca916460aceb57c77cb"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_SPA_1D_marquardt_global_exps_instr</b> (float xincr, float **trans, int ndata, int ntrans, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], int ftype, float **param, int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, int drop_bad_transients, int spa_param, int spa_nvalues, float spa_low, float spa_high, float chisq_global[], int df[], void(*progressfunc)(float))</td></tr>
<tr class="separator:a453a6f925407eca916460aceb57c77cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c7cdbe73b7ec002bd6e8ac431b9d3e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad8c7cdbe73b7ec002bd6e8ac431b9d3e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_SPA_2D_marquardt_global_exps_instr</b> (float xincr, float **trans, int ndata, int ntrans, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], int ftype, float **param, int paramfree[], int nparam, <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, int drop_bad_transients, int spa_param1, int spa_nvalues1, float spa_low1, float spa_high1, int spa_param2, int spa_nvalues2, float spa_low2, float spa_high2, float **chisq_global, int **df, void(*progressfunc)(float))</td></tr>
<tr class="separator:ad8c7cdbe73b7ec002bd6e8ac431b9d3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3061b9b85996dba7b3342592671a3733"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3061b9b85996dba7b3342592671a3733"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_SPA_1D_marquardt_global_generic_instr</b> (float xincr, float **trans, int ndata, int ntrans, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float **param, int paramfree[], int nparam, int gparam[], <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, void(*fitfunc)(float, float[], float *, float[], int), int spa_param, int spa_nvalues, float spa_low, float spa_high, float chisq_global[], int df[], void(*progressfunc)(float))</td></tr>
<tr class="separator:a3061b9b85996dba7b3342592671a3733"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7179d4f6287c800aa0a0cf229a8f1634"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7179d4f6287c800aa0a0cf229a8f1634"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_SPA_2D_marquardt_global_generic_instr</b> (float xincr, float **trans, int ndata, int ntrans, int fit_start, int fit_end, float instr[], int ninstr, <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a> noise, float sig[], float **param, int paramfree[], int nparam, int gparam[], <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a> restrain, float chisq_delta, void(*fitfunc)(float, float[], float *, float[], int), int spa_param1, int spa_nvalues1, float spa_low1, float spa_high1, int spa_param2, int spa_nvalues2, float spa_low2, float spa_high2, float **chisq_global, int **df, void(*progressfunc)(float))</td></tr>
<tr class="separator:a7179d4f6287c800aa0a0cf229a8f1634"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bdc3c1da7c48ac0dac24ad0192be828"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6bdc3c1da7c48ac0dac24ad0192be828"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_set_restrain_limits</b> (int nparam, int restrain[], float minval[], float maxval[])</td></tr>
<tr class="separator:a6bdc3c1da7c48ac0dac24ad0192be828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2344b98c118e8e514a67a6331235525a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2344b98c118e8e514a67a6331235525a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_multiexp_lambda</b> (float x, float param[], float *y, float dy_dparam[], int nparam)</td></tr>
<tr class="separator:a2344b98c118e8e514a67a6331235525a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac180a3ee448f5962b0f0af64fe809e3d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac180a3ee448f5962b0f0af64fe809e3d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_multiexp_tau</b> (float x, float param[], float *y, float dy_dparam[], int nparam)</td></tr>
<tr class="separator:ac180a3ee448f5962b0f0af64fe809e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5e64cbb4216ace85ecb0f4529fd3aa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abd5e64cbb4216ace85ecb0f4529fd3aa"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_stretchedexp</b> (float x, float param[], float *y, float dy_dparam[], int nparam)</td></tr>
<tr class="separator:abd5e64cbb4216ace85ecb0f4529fd3aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ad195c79ea0a1f4f1065d0ca2e9023e"><td class="memItemLeft" align="right" valign="top">float **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_ecf_8h.html#a2ad195c79ea0a1f4f1065d0ca2e9023e">GCI_ecf_matrix</a> (long nrows, long ncols)</td></tr>
<tr class="memdesc:a2ad195c79ea0a1f4f1065d0ca2e9023e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a 2d matrix for ecf fitting.  <a href="#a2ad195c79ea0a1f4f1065d0ca2e9023e">More...</a><br/></td></tr>
<tr class="separator:a2ad195c79ea0a1f4f1065d0ca2e9023e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd88f267cae9ae28b315c683b4b82732"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afd88f267cae9ae28b315c683b4b82732"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>GCI_ecf_free_matrix</b> (float **m)</td></tr>
<tr class="separator:afd88f267cae9ae28b315c683b4b82732"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae63f74d4be13a796382e2fef38ada44d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae63f74d4be13a796382e2fef38ada44d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ECF_ExportParams_start</b> (char path[])</td></tr>
<tr class="separator:ae63f74d4be13a796382e2fef38ada44d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a822aae0e48446f43c31f5cf70a87af1c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a822aae0e48446f43c31f5cf70a87af1c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ECF_ExportParams_stop</b> (void)</td></tr>
<tr class="separator:a822aae0e48446f43c31f5cf70a87af1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SLIM Curve - Exponential Curve Fitting Header. </p>

<p>Definition in file <a class="el" href="_ecf_8h_source.html">Ecf.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a02b14794ec966816ffe397474b985361"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_ecf_8h.html#a02b14794ec966816ffe397474b985361">fit_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fit Type. </p>
<p>Chooses between a multi-exponential fit and the special 'stretched' exponential. </p>

<p>Definition at line <a class="el" href="_ecf_8h_source.html#l00051">51</a> of file <a class="el" href="_ecf_8h_source.html">Ecf.h</a>.</p>

</div>
</div>
<a class="anchor" id="a603ad628eaeb162f9f6326cbec927b89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Noise Type. </p>
<p>'NOISE_CONST' - every data point is assumed to have the same supplied variance.<br/>
 'NOISE_GIVEN' - every data point can have an individual variance, given via a data array.<br/>
 'NOISE_GAUSSIAN_FIT' - Variance for Gaussian distribution is used at all data points Variants based on the data or the fit.<br/>
 'NOISE_POISSON_DATA and NOISE_POISSON_FIT' - Variance for Gaussian distribution is used with a lower limit of 15, this being the point where the Gaussian approximation begins to break down with Poissonian data. Variants based on the data or the fit.<br/>
 'NOISE_MLE' - Maximum Likelihood Estimation through the use of the Poisson equation (Laurence and Chromy 2010).<br/>
 </p>

<p>Definition at line <a class="el" href="_ecf_8h_source.html#l00045">45</a> of file <a class="el" href="_ecf_8h_source.html">Ecf.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab577c048e57126ea37f6656e97e547e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Restrain Type. </p>
<p>Chooses the restrain type, either the default with very wide sensible limits or 'user' defined limits. See GCI_set_restrain_limits. </p>

<p>Definition at line <a class="el" href="_ecf_8h_source.html#l00056">56</a> of file <a class="el" href="_ecf_8h_source.html">Ecf.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2ad195c79ea0a1f4f1065d0ca2e9023e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float** GCI_ecf_matrix </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>nrows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>ncols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a 2d matrix for ecf fitting. </p>

</div>
</div>
<a class="anchor" id="a5bbaf55df7653f2f443e38b6f6b1e1a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_marquardt </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>param</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>paramfree</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a>&#160;</td>
          <td class="paramname"><em>restrain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(float, float[], float *, float[], int)&#160;</td>
          <td class="paramname"><em>fitfunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>fitted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chisq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_percent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>erraxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Now for the non-linear least squares fitting algorithms. </p>
<p>The process is:</p>
<ul>
<li>for Gaussian noise, use Levenberg-Marquardt directly</li>
<li>for Poisson noise, use Levenberg-Marquardt to get an initial estimate of the parameters assuming constant error variance, then use amoeba to improve the estimate, assuming that the error variance is proportional to the function value (with a minimum variance of 15 to handle the case when the Poisson distribution is not approximately Gaussian, so that the very noisy tails do not inappropriately weight the solution).</li>
</ul>
<p>This code contains two variants of the Levenberg-Marquardt method for slightly different situations. This attempts to reduce the value chi^2 of a fit between a set of data points x[0..ndata-1], y[0..ndata-1] and a nonlinear function dependent on nparam coefficients param[0..nparam-1]. In the case that the x values are equally spaced and start at zero, we can also handle convolution with an instrument response instr[0..ninstr-1] and only look at the data points from fit_start..fit_end-1. The first variant does not handle an instrument response and takes any values of x[0..ndata-1]. The second variant takes an xincr and will handle an instrument response if ninstr &gt; 0. The individual standard deviations of the errors are determined by the value of noise: if noise=NOISE_CONST, the standard deviations are constant, given by sig[0]=*sig, if noise=NOISE_GIVEN, the standard deviations are given by sig[0..ndata-1], if noise=NOISE_POISSON_DATA, the standard deviations are taken to be given by Poisson noise, and the variances are taken to be max(y[i],15), and if noise=NOISE_POISSON_FIT, the variances are taken to be max(yfit[i],15). If noise=NOISE_GAUSSIAN_FIT, the variances are taken to be yfit[i] and if noise=NOISE_MLE then a optimisation is for the maximum likelihood approximation (Laurence and Chromy in press 2010 and G. Nishimura, and M. Tamura Phys Med Biol 2005).</p>
<p>The input array paramfree[0..nparam-1] indicates by nonzero entries those components that should be held fixed at their input values. The program returns current best-fit values for the parameters param[0..nparam-1] and chi^2 = chisq. The arrays covar[0..nparam-1][0..nparam-1] and alpha[0..nparam-1][0..nparam-1] are used as working space during most isterations. Supply a routine fitfunc(x,param,yfit,dy_dparam,nparam) that evaluates the fitting function fitfunc and its derivatives dydy[1..nparam-1] with respect to the fitting parameters param at x. (See below for information about zero offsets, though.) The values of fitfunc, modified by the instrument response, are returned in the array yfit and the differences y - yfit in dy. The first call <em>must</em> provide an initial guess for the parameters param and set alambda &lt; 0 for initialisation (which then sets alambda = 0.001). If a step succeeds, chisq becomes smaller and alambda decreases by a factor of 10. You must call this routine repeatedly until convergence is achieved. Then make one final call with alambda=0 to perform cleanups and so that covar[0..nparam-1][0..nparam-1] returns the covariance matrix and alpha the curvature matrix. (Parameters held fixed will return zero covariances.)</p>
<p>One key extra piece which is particularly important in the instrument response case. The parameter param[0] is assumed to be the zero offset of the signal, which applies before and after time zero. It thus simply contributes param[0]*sum(instr) to the signal value rather than being convolved with the instrument response only from time zero. For this reason, the fitfunc should ignore param[0], as the fitting routines will handle this offset. </p>

<p>Definition at line <a class="el" href="_ecf_single_8c_source.html#l00526">526</a> of file <a class="el" href="_ecf_single_8c_source.html">EcfSingle.c</a>.</p>

</div>
</div>
<a class="anchor" id="a94bbfd4c5b3d3a79fd840731954f3976"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_marquardt_fitting_engine </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>xincr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>prompt</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nprompt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>param</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>paramfree</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a>&#160;</td>
          <td class="paramname"><em>restrain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(float, float[], float *, float[], int)&#160;</td>
          <td class="paramname"><em>fitfunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>fitted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chisq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>covar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>erraxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chisq_percent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main entry point for LM and MLE fitting. </p>
<p>Uses GCI_marquardt_instr() to fit repeatedly until chisq_target is met or a maximum number of iterations are used. This can be used to fit any function through the 'fitfunc', but is primarily used for single, multi and stretched exponential fits. Predefined fitting models GCI_multiexp_tau and GCI_stretchedexp are provided elsewhere in the library.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xincr</td><td>The time increment in between the values in the y array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>The transient (time resolved) signal to be analysed, the 'data'. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndata</td><td>The number of data points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_start</td><td>The index into the y array marking the start to the data to be used in the fit. Some data before this start index is required for convolution with the prompt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_end</td><td>The index into the y array marking the end of the data to be used in the fit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">prompt</td><td>The instrument response (IRF) or prompt signal to be used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nprompt</td><td>The number of data points in the prompt (ignored if prompt = NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noise</td><td>The noise_type to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>The standard deviation at each data point in y if noise_type NOISE_GIVEN is used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">param</td><td>An array of parameters, the order of which must match fitfunc. Provide parameter estimates, these are overridden with the fitted values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">paramfree</td><td>An array indicating which parameters are free (1), fixed (0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nparam</td><td>The number of parameters. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">restrain</td><td>Parameter restraining type. Normally use ECF_RESTRAIN_DEFAULT. Use ECF_RESTRAIN_USER if restraining parameters has been setup via GCI_set_restrain_limits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fitfunc</td><td>Encodes the function to fit to the data, e.g. GCI_multiexp_tau. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fitted</td><td>An array containing values fitted to the data, the 'fit'. Fit points are coincident in time with the data points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">residuals</td><td>An array containing the difference between the data and the fit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chisq</td><td>The resulting raw chi squared value of the fit. To get the reduced chisq, divide by the degrees of freedom (fit_start - fit_end - nparam) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">covar</td><td>The covariance matrix. Allocate with a square matrix with GCI_ecf_matrix(nparam, nparam). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">alpha</td><td>The alpha matrix. Allocate with a square matrix with GCI_ecf_matrix(nparam, nparam). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">erraxes</td><td>The dimensions of the confidence ellipsoid of the chisq. See chisq_percent below. Allocate with a square matrix with GCI_ecf_matrix(nparam, nparam). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chisq_target</td><td>A raw chi squared value to aim for. If this value is reached fitting will stop. If you want to aim for a reduced chisq (say 1.1 or 1.0) you must multiply by the degree of freedom. (TRI2: "Try refits") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chisq_delta</td><td>An individual fit will continue if the chisq value changes by more then this amount. Try 1E-5. (TRI2: "Stopping Criterion") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chisq_percent</td><td>Defines the confidence interval when calculating the error axes, e.g. 95 %. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An error code, 0 = success.</dd></dl>
<p>The main entry point for LM and MLE fitting.</p>
<p>This returns the number of iterations or negative if an error occurred. passes all the data to the ecf routine, checks the returned chisq and re-fits if it is of benefit was DoEcfFittingEngine() included in <a class="el" href="_ecf_single_8c.html" title="SLIM Curve - Exponential Curve Fitting. ">EcfSingle.c</a> by PRB, 3.9.03 </p>

<p>Definition at line <a class="el" href="_ecf_single_8c_source.html#l01860">1860</a> of file <a class="el" href="_ecf_single_8c_source.html">EcfSingle.c</a>.</p>

</div>
</div>
<a class="anchor" id="adaf97138127a9b5b4db9de0c15a95742"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_marquardt_global_exps_instr </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>xincr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntrans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>instr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ninstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ftype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>paramfree</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a>&#160;</td>
          <td class="paramname"><em>restrain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>fitted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_trans</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chisq_global</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>drop_bad_transients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global analysis analysis function for exponential functions. </p>
<p>The main entry point for Global analysis with exponential functions. This assumes global exponential params (lifetimes) and local amplitudes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xincr</td><td>The time increment inbetween the values in the y array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>A pointer to a matrix of transient (time resolved) signals to be analysed, the 'data'. Allocate with GCI_ecf_matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndata</td><td>The number of data points in each transient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntrans</td><td>The number of transient signals (pixels in a time resolved image). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_start</td><td>The index into the y array marking the start to the data to be used in the fit. Some data before this start index is required for convolution with the prompt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_end</td><td>The index into the y array marking the end of the data to be used in the fit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">instr</td><td>The instrument reponse (IRF) or prompt signal to be used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ninstr</td><td>The number of data points in the prompt (ignored if prompt = NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noise</td><td>The noise_type to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>The standard deviation at each data point in y if noise_type NOISE_GIVEN is used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ftype</td><td>The type of function to fit can be multi-exponential (FIT_GLOBAL_MULTIEXP) or stretched exponential (FIT_GLOBAL_STRETCHEDEXP). For other fitting functions use the global generic function. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">param</td><td>A pointer to an array of parameter arrays, the order of which must match fitfunc. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">paramfree</td><td>An array indicating which parameters are free (1), fixed (0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nparam</td><td>The number of parameters per fit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">restrain</td><td>Parameter restraining type. Normally use ECF_RESTRAIN_DEFAULT. Use ECF_RESTRAIN_USER if restraining parameters has been setup via GCI_set_restrain_limits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chisq_delta</td><td>An individual fit will continue if the chisq value changes by more then this amount. Try 1E-5. (TRI2: "Stopping Criterion") </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fitted</td><td>A pointer to a matrix containing values fitted to the data, the 'fit'. Fit points are coincident in time with the data points. Only the first row is used. Allocate with GCI_ecf_matrix with nrows=1. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">residuals</td><td>A matrix containing the difference between the data and the fit. Only the first row is used. Allocate with GCI_ecf_matrix with nrows=1. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chisq_trans</td><td>An array of the resulting raw chi squared values of the fits. To get the reduced chisq, divide by the degrees of freedom (fit_start - fit_end - nparam). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chisq_global</td><td>The resulting raw chi squared value of the total global fit. To get the reduced chisq, divide by the degrees of freedom df. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">df</td><td>The degrees of freedom. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">drop_bad_transients</td><td>Remove individual transients from the fit that have a -ve return value from GCI_marquardt_global_exps_do_fit_single (default = 1) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An error code, 0 = success.</dd></dl>
<p>Global analysis analysis function for exponential functions.</p>
<p>Now the code for performing a global fit for multi-exponential taus and stretched exponentials. This is the function which is called from external programs. </p>

<p>Definition at line <a class="el" href="_ecf_global_8c_source.html#l00356">356</a> of file <a class="el" href="_ecf_global_8c_source.html">EcfGlobal.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac92d80a24a54ae6853e5c49de4e965ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_marquardt_global_generic_instr </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>xincr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ntrans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>instr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ninstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>paramfree</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>gparam</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a>&#160;</td>
          <td class="paramname"><em>restrain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(float, float[], float *, float[], int)&#160;</td>
          <td class="paramname"><em>fitfunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>fitted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_trans</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chisq_global</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>df</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global analysis analysis function for generic functions. </p>
<p>The main entry point for Global analysis with generic functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xincr</td><td>The time increment inbetween the values in the y array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>A pointer to a matrix of transient (time resolved) signals to be analysed, the 'data'. Allocate with GCI_ecf_matrix. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ndata</td><td>The number of data points in each transient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ntrans</td><td>The number of transient signals (pixels in a time resolved image). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_start</td><td>The index into the y array marking the start to the data to be used in the fit. Some data before this start index is required for convolution with the prompt. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_end</td><td>The index into the y array marking the end of the data to be used in the fit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">instr</td><td>The instrument reponse (IRF) or prompt signal to be used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ninstr</td><td>The number of data points in the prompt (ignored if prompt = NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noise</td><td>The noise_type to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>The standard deviation at each data point in y if noise_type NOISE_GIVEN is used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">param</td><td>A pointer to an array of parameter arrays, the order of which must match fitfunc. Allocate with GCI_ecf_matrix(ntrans, nparam). The global params will be the same for every transient. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">paramfree</td><td>An array indicating which parameters are free (1), fixed (0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nparam</td><td>The number of parameters per fit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gparam</td><td>An array marking which parameters are to be globally determined. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">restrain</td><td>Parameter restraining type. Normally use ECF_RESTRAIN_DEFAULT. Use ECF_RESTRAIN_USER if restraining parameters has been setup via GCI_set_restrain_limits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chisq_delta</td><td>An individual fit will continue if the chisq value changes by more then this amount. Try 1E-5. (TRI2: "Stopping Criterion") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fitfunc</td><td>Encodes the function to fit to the data, e.g. GCI_multiexp_tau. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fitted</td><td>A pointer to a matrix containing values fitted to the data, the 'fit'. Fit points are coincident in time with the data points. Only the first row is used. Allocate with GCI_ecf_matrix with nrows=1. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">residuals</td><td>A matrix containing the difference between the data and the fit. Only the first row is used. Allocate with GCI_ecf_matrix with nrows=1. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chisq_trans</td><td>An array of the resulting raw chi squared values of the fits. To get the reduced chisq, divide by the degrees of freedom (fit_start - fit_end - nparam). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chisq_global</td><td>The resulting raw chi squared value of the total global fit. To get the reduced chisq, divide by the degrees of freedom df. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">df</td><td>The degrees of freedom. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An error code, 0 = success.</dd></dl>
<p>Global analysis analysis function for generic functions.</p>
<p>These functions are essentially the same as the above functions GCI_marquardt_global_exps_instr and GCI_marquardt_global_exps_do_fit_instr and the latter's dependents, except that this version takes an arbitrary function and a list of global parameters. This function is designed to be called from external code. It is nowhere near as efficient as the streamlined code above for globally fitting taus for multi-exponential models. Also, this function must be provided with meaningful starting estimates for all parameters. </p>

<p>Definition at line <a class="el" href="_ecf_global_8c_source.html#l02707">2707</a> of file <a class="el" href="_ecf_global_8c_source.html">EcfGlobal.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae1168eba7dd501dd4427c436d6351d1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_SPA_1D_marquardt </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>param</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>paramfree</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a>&#160;</td>
          <td class="paramname"><em>restrain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(float, float[], float *, float[], int)&#160;</td>
          <td class="paramname"><em>fitfunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spa_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spa_nvalues</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spa_low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spa_high</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(float)&#160;</td>
          <td class="paramname"><em>progressfunc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GCI_SPA_1D_* performs a 1-dimensional support plane analysis. </p>
<p>It takes the same fitting paramters as the corresponding standard Marquardt function, without a few of the transient-specific parameters, and with the following extra parameters:</p>
<p>int spa_param which parameter are we analysing? int spa_nvalues how many different parameter values will we calculate chi-squared values for? float spa_low the lowest parameter value float spa_high the highest parameter value float chisq[] the resulting chisq values</p>
<p>In the case of the global analysis for exponentials function, there is an extra parameter, int df[], which gives the number of degrees of freedom for each value; this is relevant if the drop_bad_transients parameter is set. If an individual fit fails, the corresponding chisq[] value is set to -1. Also, the chisq[] array runs from chisq[0], corresponding to spa_low to chisq[spa_nvalues-1], corresponding to spa_high. </p>

<p>Definition at line <a class="el" href="_ecf_s_p_a_8c_source.html#l00069">69</a> of file <a class="el" href="_ecf_s_p_a_8c_source.html">EcfSPA.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1b39dab2b8a463ca924475c8633696e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_SPA_2D_marquardt </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>x</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ndata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>param</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>paramfree</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nparam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#ab577c048e57126ea37f6656e97e547e7">restrain_type</a>&#160;</td>
          <td class="paramname"><em>restrain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(float, float[], float *, float[], int)&#160;</td>
          <td class="paramname"><em>fitfunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spa_param1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spa_nvalues1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spa_low1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spa_high1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spa_param2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spa_nvalues2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spa_low2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>spa_high2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float **&#160;</td>
          <td class="paramname"><em>chisq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(float)&#160;</td>
          <td class="paramname"><em>progressfunc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GCI_SPA_2D_* performs a 2-dimensional support plane analysis. </p>
<p>It is the same as the 1-dimensional variant, except that now the extra parameters are:</p>
<p>int spa_param1, int spa_nvalues1, float spa_low1, float spa_high1, int spa_param1, int spa_nvalues1, float spa_low1, float spa_high1, float chisq[][], (int df[][])</p>
<p>Here chisq[i][j] will correspond to the i-th value of param1 and the j-th value of param2; chisq[][] itself will have been allocated by the GCI_ecf_matrix function.</p>
<p>In all cases where the original function must be provided with reasonable initial estimates for the parameters, so must these functions. </p>

<p>Definition at line <a class="el" href="_ecf_s_p_a_8c_source.html#l00159">159</a> of file <a class="el" href="_ecf_s_p_a_8c_source.html">EcfSPA.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad62c421e86238246287fc9cadf4bf171"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_triple_integral </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>xincr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>fitted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chisq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>division</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start with an easy one: the three integral method. </p>
<p>This returns 0 on success, negative on error. </p>

<p>Definition at line <a class="el" href="_ecf_single_8c_source.html#l00077">77</a> of file <a class="el" href="_ecf_single_8c_source.html">EcfSingle.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7790a7e8ebdca31efd349e44add17cd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GCI_triple_integral_fitting_engine </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>xincr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>y</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fit_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>instr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ninstr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_ecf_8h.html#a603ad628eaeb162f9f6326cbec927b89">noise_type</a>&#160;</td>
          <td class="paramname"><em>noise</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>sig</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>fitted</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>residuals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>chisq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>chisq_target</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main entry point for Triple Integral or Rapid Lifetime Determination (RLD). </p>
<p>Uses GCI_triple_integral_*() to fit repeatedly with different integration periods until chisq_target is met or a maximum number of iterations are used.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">xincr</td><td>The time increment inbetween the values in the y array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>The transient (time resolved) signal to be analysed, the 'data'. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_start</td><td>The index into the y array marking the start to the data to be used in the fit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fit_end</td><td>The index into the y array marking the end of the data to be used in the fit. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">instr</td><td>The instrument reponse (IRF) or prompt signal to be used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noise</td><td>The noise_type to be used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sig</td><td>The standard deviation at each data point in y if noise_type NOISE_GIVEN is used (optional, can pass NULL). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Z</td><td>The returned background value from the fit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A</td><td>The returned amplitude value from the fit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tau</td><td>The returned lifetime value from the fit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">fitted</td><td>An array containing values fitted to the data, the 'fit'. Fit points are coincident in time with the data points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">residuals</td><td>An array containing the difference between the data and the fit. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chisq</td><td>The resulting raw chi squared value of the fit. To get the reduced chisq, divide by the degrees of freedom (fit_start - fit_end - nparam) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">chisq_target</td><td>A raw chi squared value to aim for. If this value is reached fitting will stop. If you want to aim for a reduced chisq (say 1.1 or 1.0) you must multiply by the degree of freedom. (TRI2: "Try refits") </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An error code, 0 = success. </dd></dl>

<p>Definition at line <a class="el" href="_ecf_single_8c_source.html#l00381">381</a> of file <a class="el" href="_ecf_single_8c_source.html">EcfSingle.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Mar 11 2014 15:45:15 for SLIM Curve by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
